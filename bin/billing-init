#!/usr/bin/env python


from bc_client.client import BCClient


host = 'localhost:10004'
auth = {'role':'admin','secret':'qwerty'}


def process_metrics():
	metrics = [
		{ 'id': 'os_types',                  'formula': 'unit',  'type': 'time',        'aggregate': 1 },
		{ 'id': 'service_monitoring',        'formula': 'unit',  'type': 'time',        'aggregate': 1 },
		{ 'id': 'volume_bytes',              'formula': 'speed', 'type': 'bytes-usage', 'aggregate': 0 },
		{ 'id': 'snapshot_bytes',            'formula': 'speed', 'type': 'bytes-usage', 'aggregate': 0 },
		{ 'id': 'fs_bytes',                  'formula': 'speed', 'type': 'bytes-usage', 'aggregate': 0 },
		{ 'id': 'fs_get',                    'formula': 'unit',  'type': 'count',       'aggregate': 1 },
		{ 'id': 'fs_put',                    'formula': 'unit',  'type': 'count',       'aggregate': 1 },
		{ 'id': 'ipaddr_reserve',            'formula': 'time',  'type': 'time-usage',  'aggregate': 0 },
		{ 'id': 'ipaddr_use',                'formula': 'time',  'type': 'time-usage',  'aggregate': 0 },
		{ 'id': 'traffic_region_incoming',   'formula': 'unit',  'type': 'bytes',       'aggregate': 1 },
		{ 'id': 'traffic_region_outgoing',   'formula': 'unit',  'type': 'bytes',       'aggregate': 1 },
		{ 'id': 'traffic_external_incoming', 'formula': 'unit',  'type': 'bytes',       'aggregate': 1 },
		{ 'id': 'traffic_external_outgoing', 'formula': 'unit',  'type': 'bytes',       'aggregate': 1 },
	]
	Metrics = BCClient(host, auth, 30, ['metricAdd'])
	for o in metrics:
		Metrics.metricAdd(o)


def process_customers():
	customers = [
		{
			'login':          'google.com',
			'name_short':     'Google',
			'name_full':      'Google OOO (Moscow)',
			'comment':        'Important client',
#			'tariff_id':      '',
			'contact_person': 'Ted Person',
			'contact_email':  'ted.person@gmail.com',
#			'contact_phone':  '',
			'wallet':         1234567890,
			'wallet_mode':    'limit',
		},
		{
			'login':          'testy.org',
			'name_short':     'Test',
			'name_full':      'Test Inc.',
			'comment':        'Simple client',
			'wallet_mode':    'unlimit',
		}
	]
	Customers = BCClient(host, auth, 30, ['customerAdd'])
	for o in customers:
		Customers.customerAdd(o)


def process_tariffs():
	internal = {
		'id': '*',
		'name': 'Service tariff',
		'description': 'This is service tariff record is not for ordinary customers'
	}
	Tariffs = BCClient(host, auth, 30, ['tariffAddInternal', 'tariffAdd'])
	Tariffs.tariffAddInternal(internal)

	tariffs = [
		{
			'name': 'Simple testing',
			'description': 'This is try-buy tariff for new customers'
		},
		{
			'name': 'Big rich man',
			'description': 'This tariff for big customers'
		},
		{
			'name': 'Hungry student',
			'description': 'This tariff for startups and little companies'
		}
	]
	for o in tariffs:
		Tariffs.tariffAdd(o)


try:
	process_metrics()
	process_customers()
	process_tariffs()

except Exception, e:
	print 'Error:', e
