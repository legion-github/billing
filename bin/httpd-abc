#!/usr/bin/env python

import logging

from c2 import config
from c2 import syslog
from c2 import jsonrpc

from bc.private.wapi import testy
from bc.private.wapi import tasks

LOG = logging.getLogger("c2.abc")

def application(environ, start_response):
	"""Main entry point of the WSGI application."""
	return jsonrpc.wsgi.jsonrpc_handle(environ, start_response)


DEVELOP_MODE = (__name__ == "__main__")

def main():
	config.init("abc")

	if DEVELOP_MODE:
		from wsgiref.simple_server import make_server

		syslog.sys_log(level = "debug", namespace = "")

		host = "0.0.0.0"
		port = 10080
		LOG.info("Running HTTP server on %s:%s...", host, port)

		httpd = make_server(host, port, application)
		httpd.serve_forever()
	else:
		syslog.sys_log(level = "debug", namespace = "")

main()

